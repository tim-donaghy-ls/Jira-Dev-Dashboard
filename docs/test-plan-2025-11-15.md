# Test Plan - JIRA Dev Dashboard
**Date:** 2025-11-15
**Status:** In Progress

## Executive Summary
Comprehensive test generation and execution plan to improve coverage across backend (Go), frontend (React/TypeScript), and end-to-end (Playwright) tests.

## Current Coverage Analysis

### Backend (Go)
| Package | Coverage | Status |
|---------|----------|--------|
| main | 0% | ❌ Critical - No tests |
| analysis | 100% | ✅ Complete |
| api/handlers | 25% | ⚠️ Needs expansion |
| config | 100% | ✅ Complete |
| jira | 94.8% | ✅ Near complete |
| aha | 0% | ❌ Critical - No tests |
| github | 0% | ❌ Critical - No tests |

**Total Backend Files:** ~16 Go files
**Test Files:** 5 existing

### Frontend (React/TypeScript)
**Total Source Files:** 47 TypeScript/TSX files
**Test Files:** 18 existing
**Coverage:** ~38%

**Components WITH Tests:**
- ChartsOverview, ConnectionStatus, Controls, ErrorMessage
- Header, IssueCard, LoadingSpinner, PriorityChart
- StatusChart, StoryPointsWarning, SummaryCards, TeamPerformanceTable
- ThemeToggle

**Components MISSING Tests (High Priority):**
- ChatDrawer.tsx (AI chat interface - critical)
- DashboardChat.tsx (main chat component)
- ReleaseNotesModal.tsx (release generation)
- SprintAnalysisModal.tsx (sprint analysis)
- AhaVerificationBadge.tsx (Aha integration)
- AhaWarning.tsx (validation warnings)
- DeveloperDevTimeChart.tsx
- DeveloperStoryPointsChart.tsx
- DeveloperWorkload.tsx
- DeveloperWorkloadChart.tsx
- SprintSlippage.tsx
- UnassignedTicketsWarning.tsx
- UserMenu.tsx
- ChartModal.tsx

**API Routes MISSING Tests:**
- /api/chat/route.ts (AI chat)
- /api/generate-sprint-analysis/route.ts

### E2E Tests (Playwright)
**Status:** ❌ No tests exist
**Priority:** Create critical user flow tests

## Test Generation Plan

### Phase 1: Backend Critical Gaps (Priority 1)

#### 1.1 Aha Client Tests (`tests/backend/aha_client_test.go`)
- Test connection validation
- Test feature verification API
- Test error handling
- Test authentication
- **Target Coverage:** 80%+

#### 1.2 GitHub Client Tests (`tests/backend/github_client_test.go`)
- Test repository stats fetching
- Test PR data retrieval
- Test commit history
- Test developer activity aggregation
- Test error handling and rate limiting
- **Target Coverage:** 80%+

#### 1.3 Main Package Tests (`tests/backend/main_test.go`)
- Test CORS middleware
- Test logging middleware
- Test server initialization
- Test multi-instance JIRA setup
- **Target Coverage:** 70%+

#### 1.4 API Handler Expansion (`tests/backend/handlers_extended_test.go`)
- Test GitHub endpoints
- Test Aha endpoints
- Test search endpoint
- Test error scenarios
- **Target Coverage:** Increase from 25% to 70%+

### Phase 2: Frontend Critical Components (Priority 1)

#### 2.1 AI Chat Components
- `tests/frontend/ChatDrawer.test.tsx` - Drawer UI, state management
- `tests/frontend/DashboardChat.test.tsx` - Chat interactions, message rendering
- `tests/frontend/api/chat/route.test.ts` - API endpoint testing

#### 2.2 Modal Components
- `tests/frontend/ReleaseNotesModal.test.tsx` - Release generation UI
- `tests/frontend/SprintAnalysisModal.test.tsx` - Sprint analysis display
- `tests/frontend/ChartModal.test.tsx` - Chart interactions

#### 2.3 Developer Performance Components
- `tests/frontend/DeveloperWorkload.test.tsx`
- `tests/frontend/DeveloperWorkloadChart.test.tsx`
- `tests/frontend/DeveloperDevTimeChart.test.tsx`
- `tests/frontend/DeveloperStoryPointsChart.test.tsx`

#### 2.4 Integration Components
- `tests/frontend/AhaVerificationBadge.test.tsx`
- `tests/frontend/AhaWarning.test.tsx`
- `tests/frontend/SprintSlippage.test.tsx`
- `tests/frontend/UnassignedTicketsWarning.test.tsx`
- `tests/frontend/UserMenu.test.tsx`

### Phase 3: E2E Critical User Flows (Priority 2)

#### 3.1 Core Dashboard Flow (`tests/e2e/dashboard.spec.ts`)
- Load dashboard with multiple JIRA instances
- Switch between instances
- View all summary cards
- Interact with charts

#### 3.2 Developer Analytics Flow (`tests/e2e/developer-analytics.spec.ts`)
- View developer workload
- Filter by developer
- View individual developer metrics
- Export data to Excel

#### 3.3 AI Assistant Flow (`tests/e2e/ai-chat.spec.ts`)
- Open chat drawer
- Send message to AI
- Receive and render response
- Generate sprint analysis
- Generate release notes

#### 3.4 GitHub Integration Flow (`tests/e2e/github-integration.spec.ts`)
- View GitHub stats
- View PR activity
- View commit history
- Cross-reference JIRA issues

#### 3.5 Aha Integration Flow (`tests/e2e/aha-integration.spec.ts`)
- Test Aha connection
- Verify features against Aha
- View verification badges
- Handle verification failures

## Test Execution Order

1. **Backend Unit Tests** (Run first - fastest)
   ```bash
   go test ./... -v -cover -coverprofile=coverage.out
   ```

2. **Frontend Unit Tests** (Run second - component isolation)
   ```bash
   npm --prefix frontend test -- --run --coverage
   ```

3. **E2E Tests** (Run last - requires running application)
   ```bash
   SKIP_AUTH=true ./start.sh
   npx playwright test
   ```

## Success Criteria

### Minimum Acceptable Coverage
- Backend: 70% overall
- Frontend: 70% overall
- E2E: All critical user flows covered

### Quality Metrics
- All tests pass consistently
- No flaky tests
- Test execution time < 5 minutes total
- Clear test descriptions
- Proper error messages

## Dependencies & Requirements

### Backend Testing
- Go 1.16+
- Mock HTTP clients for external APIs
- Test fixtures for JIRA/GitHub/Aha responses

### Frontend Testing
- Vitest test runner
- React Testing Library
- Mock API responses
- Test utilities in `frontend/test/setup.ts`

### E2E Testing
- Playwright installed
- Backend and frontend running
- SKIP_AUTH=true for test environment
- Test data seeded

## Risk Mitigation

### High Risk Areas
1. **AI Chat Integration** - External API, token limits, streaming
2. **Multi-Instance JIRA** - Complex state management
3. **Excel Export** - Large data sets, memory usage
4. **GitHub Rate Limiting** - API quotas

### Mitigation Strategies
- Mock external APIs in tests
- Use test fixtures for reproducibility
- Test error scenarios explicitly
- Implement retry logic testing

## Timeline

- **Backend Tests:** 2 hours (Phases 1.1-1.4)
- **Frontend Tests:** 3 hours (Phases 2.1-2.4)
- **E2E Tests:** 2 hours (Phases 3.1-3.5)
- **Test Execution & Fixes:** 1 hour
- **Documentation & Reporting:** 30 minutes

**Total Estimated Time:** 8.5 hours

## Next Steps

1. ✅ Complete requirement analysis
2. ✅ Create test plan
3. ⏳ Generate backend tests (parallel agents)
4. ⏳ Generate frontend tests (parallel agents)
5. ⏳ Generate E2E tests (parallel agents)
6. ⏳ Execute all tests
7. ⏳ Generate comprehensive report
